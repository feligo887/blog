(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{323:function(e,n,t){"use strict";t.r(n);var s=t(5),r=Object(s.a)({},(function(){var e=this,n=e._self._c;return n("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[n("h3",{attrs:{id:"实现一个promise的基本逻辑整理"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#实现一个promise的基本逻辑整理"}},[e._v("#")]),e._v(" 实现一个Promise的基本逻辑整理")]),e._v(" "),n("ol",[n("li",[e._v("我们用new Promise申明一个promise，所以promise就是一个类")]),e._v(" "),n("li",[e._v("在执行这个类的时候，会传递一个执行器并立即执行。")]),e._v(" "),n("li",[e._v("promise的三种状态：pending（初始化）、fulfilled（成功）、rejected（失败）")]),e._v(" "),n("li",[e._v("resolve：pending ->fulfilled || reject：pending ->rejected 状态一旦确定就不能更改")]),e._v(" "),n("li",[e._v(".then()方法会内部会判断 promise 的状态成功还是失败，成功调用成功函数，失败调用失败函数")]),e._v(" "),n("li",[e._v(".then() 是被定义在原型对象中的，成功和失败都各有一个参数，代表回调结果")])]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v('// 步骤3\nconst PADDING = "padding";\nconst FULFILLED = "fulfilled";\nconst REJECTED = "rejected";\n\n// 步骤1\nclass KPromise {\n    // 步骤2\n    constructor(executor) {\n        executor(this.resolve,this.rejected)\n    }\n\n    //  步骤3\n    //  Promise状态\n    status = PADDING;\n\n    //  步骤6\n    //  resolve 返回数据\n    resolveData = undefined;\n    //  rejected 返回数据\n    rejectedData = undefined;\n    \n    //  步骤2\n    resolve = (val) => {\n        //  步骤4\n        if(this.status === PADDING) {\n            //  将状态改为成功\n            this.status = FULFILLED;\n            this.resolveData = val;\n        }\n    }\n    //  步骤2\n    rejected = (error) => {\n        //  步骤4\n        if(this.status === PADDING) {\n            //  将状态改为失败\n            this.status = REJECTED;\n            this.rejectedData = error;\n        }\n    }\n\n    then(resolveCallback,rejectedCallback) {\n        //  步骤5\n        if(this.status === FULFILLED) {\n            //  步骤6\n            resolveCallback(this.resolveData);\n        }else if(this.status === REJECTED) {\n            //  步骤6\n            rejectedCallback(this.rejectedData);\n        }\n\n    }\n}\n')])])])])}),[],!1,null,null,null);n.default=r.exports}}]);